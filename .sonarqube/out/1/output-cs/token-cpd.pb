í€
<D:\repositoriosGit\Chat\Chat\xSqlService\XirectServiceSQL.cs
	namespace 	
xSqlService
 
{ 
public 

sealed 
class 
XirectServiceSQL (
{ 
private 
string 
cadenaConexion %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
static 
readonly 
XirectServiceSQL  0
servicio1 9
=: ;
new< ?
XirectServiceSQL@ P
(P Q
)Q R
;R S
public 
static 
XirectServiceSQL &
	Instancia' 0
{ 	
get 
{ 
return 
servicio !
;! "
}# $
} 	
private"" 
XirectServiceSQL""  
(""  !
)""! "
{## 	
if$$ 
($$ 
string$$ 
.$$ 
IsNullOrEmpty$$ $
($$$ %
cadenaConexion$$% 3
)$$3 4
)$$4 5
{%% 
cadenaConexion'' 
=''   
ConfigurationManager''! 5
.''5 6
ConnectionStrings''6 G
[''G H
$str''H V
]''V W
.''W X
ToString''X `
(''` a
)''a b
;''b c
}77 
}88 	
public>> 
SqlConnection>> 
AbrirConexion>> *
(>>* +
)>>+ ,
{?? 	
SqlConnection@@ 
osqlcon@@ !
=@@" #
new@@$ '
SqlConnection@@( 5
(@@5 6
cadenaConexion@@6 D
)@@D E
;@@E F
osqlconAA 
.AA 
OpenAA 
(AA 
)AA 
;AA 
returnBB 
osqlconBB 
;BB 
}CC 	
publicEE 
SqlTransactionEE 
AbrirTransaccionEE .
(EE. /
SqlConnectionEE/ <
oconsqlEE= D
)EED E
{FF 	
returnGG 
oconsqlGG 
.GG 
BeginTransactionGG +
(GG+ ,
)GG, -
;GG- .
}HH 	
publicUU 
DataRowUU 
EjecutarRegistroUU '
(UU' (
stringUU( .
entidadUU/ 6
,UU6 7
stringUU8 >
claveUU? D
,UUD E
	HashtableUUF O

parametrosUUP Z
=UU[ \
nullUU] a
)UUa b
{VV 	
	DataTableWW 
dtresultadoWW !
=WW" #
EjecutarTablaWW$ 1
(WW1 2
entidadWW2 9
,WW9 :
claveWW; @
,WW@ A

parametrosWWB L
)WWL M
;WWM N
ifYY 
(YY 
dtresultadoYY 
==YY 
nullYY #
||YY$ &
dtresultadoYY' 2
.YY2 3
RowsYY3 7
==YY8 :
nullYY; ?
||YY@ B
dtresultadoYYC N
.YYN O
RowsYYO S
.YYS T
CountYYT Y
==YYZ \
$numYY] ^
)YY^ _
returnZZ 
nullZZ 
;ZZ 
return\\ 
dtresultado\\ 
.\\ 
Rows\\ #
[\\# $
$num\\$ %
]\\% &
;\\& '
}]] 	
publicff 
	DataTableff 
EjecutarTablaff &
(ff& '
stringff' -
entidadff. 5
,ff5 6
stringff7 =
claveff> C
,ffC D
	HashtableffE N

parametrosffO Y
=ffZ [
nullff\ `
)ff` a
{gg 	
	DataTablehh 
dtresultadohh !
=hh" #
newhh$ '
	DataTablehh( 1
(hh1 2
)hh2 3
;hh3 4
usingjj 
(jj 
SqlConnectionjj  
osqlconjj! (
=jj) *
newjj+ .
SqlConnectionjj/ <
(jj< =
cadenaConexionjj= K
)jjK L
)jjL M
{kk 
osqlconll 
.ll 
Openll 
(ll 
)ll 
;ll 
usingnn 
(nn 

SqlCommandnn !
osqlcomnn" )
=nn* +
EstablecerComandonn, =
(nn= >
osqlconnn> E
,nnE F
nullnnG K
,nnK L
entidadnnM T
,nnT U
clavennV [
,nn[ \

parametrosnn] g
)nng h
)nnh i
{oo 
dtresultadopp 
.pp  
Loadpp  $
(pp$ %
osqlcompp% ,
.pp, -
ExecuteReaderpp- :
(pp: ;
)pp; <
)pp< =
;pp= >,
 RecuperarValoresParametrosSalidaqq 4
(qq4 5
osqlcomqq5 <
,qq< =

parametrosqq> H
)qqH I
;qqI J
}rr 
}ss 
returnuu 
dtresultadouu 
;uu 
}vv 	
public
ÅÅ 
DataSet
ÅÅ 
EjecutarDataSet
ÅÅ &
(
ÅÅ& '
string
ÅÅ' -
entidad
ÅÅ. 5
,
ÅÅ5 6
string
ÅÅ7 =
clave
ÅÅ> C
,
ÅÅC D
	Hashtable
ÅÅE N

parametros
ÅÅO Y
,
ÅÅY Z
params
ÅÅ[ a
string
ÅÅb h
[
ÅÅh i
]
ÅÅi j
tablas
ÅÅk q
)
ÅÅq r
{
ÇÇ 	
DataSet
ÉÉ 
dsresultado
ÉÉ 
=
ÉÉ  !
new
ÉÉ" %
DataSet
ÉÉ& -
(
ÉÉ- .
)
ÉÉ. /
;
ÉÉ/ 0
using
ÖÖ 
(
ÖÖ 
SqlConnection
ÖÖ  
osqlcon
ÖÖ! (
=
ÖÖ) *
new
ÖÖ+ .
SqlConnection
ÖÖ/ <
(
ÖÖ< =
cadenaConexion
ÖÖ= K
)
ÖÖK L
)
ÖÖL M
{
ÜÜ 
osqlcon
áá 
.
áá 
Open
áá 
(
áá 
)
áá 
;
áá 
using
ââ 
(
ââ 

SqlCommand
ââ !
osqlcom
ââ" )
=
ââ* +
EstablecerComando
ââ, =
(
ââ= >
osqlcon
ââ> E
,
ââE F
null
ââG K
,
ââK L
entidad
ââM T
,
ââT U
clave
ââV [
,
ââ[ \

parametros
ââ] g
)
ââg h
)
ââh i
{
ää 
dsresultado
ãã 
.
ãã  
Load
ãã  $
(
ãã$ %
osqlcom
ãã% ,
.
ãã, -
ExecuteReader
ãã- :
(
ãã: ;
)
ãã; <
,
ãã< =

LoadOption
ãã> H
.
ããH I
OverwriteChanges
ããI Y
,
ããY Z
tablas
ãã[ a
)
ããa b
;
ããb c.
 RecuperarValoresParametrosSalida
çç 4
(
çç4 5
osqlcom
çç5 <
,
çç< =

parametros
çç> H
)
ççH I
;
ççI J
}
éé 
}
èè 
return
ëë 
dsresultado
ëë 
;
ëë 
}
íí 	
public
õõ 
int
õõ 
EjecutarComando
õõ "
(
õõ" #
string
õõ# )
entidad
õõ* 1
,
õõ1 2
string
õõ3 9
clave
õõ: ?
,
õõ? @
	Hashtable
õõA J

parametros
õõK U
=
õõV W
null
õõX \
)
õõ\ ]
{
úú 	
using
ùù 
(
ùù 
SqlConnection
ùù  
osqlcon
ùù! (
=
ùù) *
new
ùù+ .
SqlConnection
ùù/ <
(
ùù< =
cadenaConexion
ùù= K
)
ùùK L
)
ùùL M
{
ûû 
osqlcon
üü 
.
üü 
Open
üü 
(
üü 
)
üü 
;
üü 
using
°° 
(
°° 

SqlCommand
°° !
osqlcom
°°" )
=
°°* +
EstablecerComando
°°, =
(
°°= >
osqlcon
°°> E
,
°°E F
null
°°G K
,
°°K L
entidad
°°M T
,
°°T U
clave
°°V [
,
°°[ \

parametros
°°] g
)
°°g h
)
°°h i
{
¢¢ 
osqlcom
££ 
.
££ 
ExecuteNonQuery
££ +
(
££+ ,
)
££, -
;
££- ..
 RecuperarValoresParametrosSalida
•• 4
(
••4 5
osqlcom
••5 <
,
••< =

parametros
••> H
)
••H I
;
••I J
}
¶¶ 
}
ßß 
return
©© 
$num
©© 
;
©© 
}
™™ 	
public
∏∏ 
DataRow
∏∏ 
EjecutarRegistro
∏∏ '
(
∏∏' (
SqlConnection
∏∏( 5
osqlcon
∏∏6 =
,
∏∏= >
string
∏∏? E
entidad
∏∏F M
,
∏∏M N
string
∏∏O U
clave
∏∏V [
,
∏∏[ \
	Hashtable
∏∏] f

parametros
∏∏g q
=
∏∏r s
null
∏∏t x
)
∏∏x y
{
ππ 	
	DataTable
∫∫ 
dtresultado
∫∫ !
=
∫∫" #
EjecutarTabla
∫∫$ 1
(
∫∫1 2
osqlcon
∫∫2 9
,
∫∫9 :
entidad
∫∫; B
,
∫∫B C
clave
∫∫D I
,
∫∫I J

parametros
∫∫K U
)
∫∫U V
;
∫∫V W
if
ºº 
(
ºº 
dtresultado
ºº 
==
ºº 
null
ºº #
||
ºº$ &
dtresultado
ºº' 2
.
ºº2 3
Rows
ºº3 7
==
ºº8 :
null
ºº; ?
||
ºº@ B
dtresultado
ººC N
.
ººN O
Rows
ººO S
.
ººS T
Count
ººT Y
==
ººZ \
$num
ºº] ^
)
ºº^ _
return
ΩΩ 
null
ΩΩ 
;
ΩΩ 
return
øø 
dtresultado
øø 
.
øø 
Rows
øø #
[
øø# $
$num
øø$ %
]
øø% &
;
øø& '
}
¿¿ 	
public
   
	DataTable
   
EjecutarTabla
   &
(
  & '
SqlConnection
  ' 4
osqlcon
  5 <
,
  < =
string
  > D
entidad
  E L
,
  L M
string
  N T
clave
  U Z
,
  Z [
	Hashtable
  \ e

parametros
  f p
=
  q r
null
  s w
)
  w x
{
ÀÀ 	
	DataTable
ÃÃ 
dtresultado
ÃÃ !
=
ÃÃ" #
new
ÃÃ$ '
	DataTable
ÃÃ( 1
(
ÃÃ1 2
)
ÃÃ2 3
;
ÃÃ3 4
using
ŒŒ 
(
ŒŒ 

SqlCommand
ŒŒ 
osqlcom
ŒŒ %
=
ŒŒ& '
EstablecerComando
ŒŒ( 9
(
ŒŒ9 :
osqlcon
ŒŒ: A
,
ŒŒA B
null
ŒŒC G
,
ŒŒG H
entidad
ŒŒI P
,
ŒŒP Q
clave
ŒŒR W
,
ŒŒW X

parametros
ŒŒY c
)
ŒŒc d
)
ŒŒd e
{
œœ 
dtresultado
–– 
.
–– 
Load
––  
(
––  !
osqlcom
––! (
.
––( )
ExecuteReader
––) 6
(
––6 7
)
––7 8
)
––8 9
;
––9 :
}
—— 
return
”” 
dtresultado
”” 
;
”” 
}
‘‘ 	
public
ﬂﬂ 
DataSet
ﬂﬂ 
EjecutarDataSet
ﬂﬂ &
(
ﬂﬂ& '
SqlConnection
ﬂﬂ' 4
osqlcon
ﬂﬂ5 <
,
ﬂﬂ< =
string
ﬂﬂ> D
entidad
ﬂﬂE L
,
ﬂﬂL M
string
ﬂﬂN T
clave
ﬂﬂU Z
,
ﬂﬂZ [
	Hashtable
ﬂﬂ\ e

parametros
ﬂﬂf p
,
ﬂﬂp q
params
ﬂﬂr x
string
ﬂﬂy 
[ﬂﬂ Ä
]ﬂﬂÄ Å
tablasﬂﬂÇ à
)ﬂﬂà â
{
‡‡ 	
DataSet
·· 
dsresultado
·· 
=
··  !
new
··" %
DataSet
··& -
(
··- .
)
··. /
;
··/ 0
using
„„ 
(
„„ 

SqlCommand
„„ 
osqlcom
„„ %
=
„„& '
EstablecerComando
„„( 9
(
„„9 :
osqlcon
„„: A
,
„„A B
null
„„C G
,
„„G H
entidad
„„I P
,
„„P Q
clave
„„R W
,
„„W X

parametros
„„Y c
)
„„c d
)
„„d e
{
‰‰ 
dsresultado
ÂÂ 
.
ÂÂ 
Load
ÂÂ  
(
ÂÂ  !
osqlcom
ÂÂ! (
.
ÂÂ( )
ExecuteReader
ÂÂ) 6
(
ÂÂ6 7
)
ÂÂ7 8
,
ÂÂ8 9

LoadOption
ÂÂ: D
.
ÂÂD E
OverwriteChanges
ÂÂE U
,
ÂÂU V
tablas
ÂÂW ]
)
ÂÂ] ^
;
ÂÂ^ _
}
ÊÊ 
return
ËË 
dsresultado
ËË 
;
ËË 
}
ÈÈ 	
public
ÛÛ 
int
ÛÛ 
EjecutarComando
ÛÛ "
(
ÛÛ" #
SqlConnection
ÛÛ# 0
osqlcon
ÛÛ1 8
,
ÛÛ8 9
string
ÛÛ: @
entidad
ÛÛA H
,
ÛÛH I
string
ÛÛJ P
clave
ÛÛQ V
,
ÛÛV W
	Hashtable
ÛÛX a

parametros
ÛÛb l
=
ÛÛm n
null
ÛÛo s
)
ÛÛs t
{
ÙÙ 	
using
ıı 
(
ıı 

SqlCommand
ıı 
osqlcom
ıı %
=
ıı& '
EstablecerComando
ıı( 9
(
ıı9 :
osqlcon
ıı: A
,
ııA B
null
ııC G
,
ııG H
entidad
ııI P
,
ııP Q
clave
ııR W
,
ııW X

parametros
ııY c
)
ııc d
)
ııd e
{
ˆˆ 
return
˜˜ 
osqlcom
˜˜ 
.
˜˜ 
ExecuteNonQuery
˜˜ .
(
˜˜. /
)
˜˜/ 0
;
˜˜0 1
}
¯¯ 
}
˘˘ 	
public
áá 
DataRow
áá 
EjecutarRegistro
áá '
(
áá' (
SqlTransaction
áá( 6
osqltran
áá7 ?
,
áá? @
string
ááA G
entidad
ááH O
,
ááO P
string
ááQ W
clave
ááX ]
,
áá] ^
	Hashtable
áá_ h

parametros
áái s
=
áát u
null
ááv z
)
ááz {
{
àà 	
	DataTable
ââ 
dtresultado
ââ !
=
ââ" #
EjecutarTabla
ââ$ 1
(
ââ1 2
osqltran
ââ2 :
,
ââ: ;
entidad
ââ< C
,
ââC D
clave
ââE J
,
ââJ K

parametros
ââL V
)
ââV W
;
ââW X
if
ãã 
(
ãã 
dtresultado
ãã 
==
ãã 
null
ãã #
||
ãã$ &
dtresultado
ãã' 2
.
ãã2 3
Rows
ãã3 7
==
ãã8 :
null
ãã; ?
||
ãã@ B
dtresultado
ããC N
.
ããN O
Rows
ããO S
.
ããS T
Count
ããT Y
==
ããZ \
$num
ãã] ^
)
ãã^ _
return
åå 
null
åå 
;
åå 
return
éé 
dtresultado
éé 
.
éé 
Rows
éé #
[
éé# $
$num
éé$ %
]
éé% &
;
éé& '
}
èè 	
public
ôô 
	DataTable
ôô 
EjecutarTabla
ôô &
(
ôô& '
SqlTransaction
ôô' 5
osqltran
ôô6 >
,
ôô> ?
string
ôô@ F
entidad
ôôG N
,
ôôN O
string
ôôP V
clave
ôôW \
,
ôô\ ]
	Hashtable
ôô^ g

parametros
ôôh r
=
ôôs t
null
ôôu y
)
ôôy z
{
öö 	
	DataTable
õõ 
dtresultado
õõ !
=
õõ" #
new
õõ$ '
	DataTable
õõ( 1
(
õõ1 2
)
õõ2 3
;
õõ3 4
using
ùù 
(
ùù 

SqlCommand
ùù 
osqlcom
ùù %
=
ùù& '
EstablecerComando
ùù( 9
(
ùù9 :
osqltran
ùù: B
.
ùùB C

Connection
ùùC M
,
ùùM N
osqltran
ùùO W
,
ùùW X
entidad
ùùY `
,
ùù` a
clave
ùùb g
,
ùùg h

parametros
ùùi s
)
ùùs t
)
ùùt u
{
ûû 
dtresultado
üü 
.
üü 
Load
üü  
(
üü  !
osqlcom
üü! (
.
üü( )
ExecuteReader
üü) 6
(
üü6 7
)
üü7 8
)
üü8 9
;
üü9 :
}
†† 
return
¢¢ 
dtresultado
¢¢ 
;
¢¢ 
}
££ 	
public
ÆÆ 
DataSet
ÆÆ 
EjecutarDataSet
ÆÆ &
(
ÆÆ& '
SqlTransaction
ÆÆ' 5
osqltran
ÆÆ6 >
,
ÆÆ> ?
string
ÆÆ@ F
entidad
ÆÆG N
,
ÆÆN O
string
ÆÆP V
clave
ÆÆW \
,
ÆÆ\ ]
	Hashtable
ÆÆ^ g

parametros
ÆÆh r
,
ÆÆr s
params
ÆÆt z
stringÆÆ{ Å
[ÆÆÅ Ç
]ÆÆÇ É
tablasÆÆÑ ä
)ÆÆä ã
{
ØØ 	
DataSet
∞∞ 
dsresultado
∞∞ 
=
∞∞  !
new
∞∞" %
DataSet
∞∞& -
(
∞∞- .
)
∞∞. /
;
∞∞/ 0
using
≤≤ 
(
≤≤ 

SqlCommand
≤≤ 
osqlcom
≤≤ %
=
≤≤& '
EstablecerComando
≤≤( 9
(
≤≤9 :
osqltran
≤≤: B
.
≤≤B C

Connection
≤≤C M
,
≤≤M N
osqltran
≤≤O W
,
≤≤W X
entidad
≤≤Y `
,
≤≤` a
clave
≤≤b g
,
≤≤g h

parametros
≤≤i s
)
≤≤s t
)
≤≤t u
{
≥≥ 
dsresultado
¥¥ 
.
¥¥ 
Load
¥¥  
(
¥¥  !
osqlcom
¥¥! (
.
¥¥( )
ExecuteReader
¥¥) 6
(
¥¥6 7
)
¥¥7 8
,
¥¥8 9

LoadOption
¥¥: D
.
¥¥D E
OverwriteChanges
¥¥E U
,
¥¥U V
tablas
¥¥W ]
)
¥¥] ^
;
¥¥^ _
}
µµ 
return
∑∑ 
dsresultado
∑∑ 
;
∑∑ 
}
∏∏ 	
public
¬¬ 
int
¬¬ 
EjecutarComando
¬¬ "
(
¬¬" #
SqlTransaction
¬¬# 1
osqltran
¬¬2 :
,
¬¬: ;
string
¬¬< B
entidad
¬¬C J
,
¬¬J K
string
¬¬L R
clave
¬¬S X
,
¬¬X Y
	Hashtable
¬¬Z c

parametros
¬¬d n
=
¬¬o p
null
¬¬q u
)
¬¬u v
{
√√ 	
using
ƒƒ 
(
ƒƒ 

SqlCommand
ƒƒ 
osqlcom
ƒƒ %
=
ƒƒ& '
EstablecerComando
ƒƒ( 9
(
ƒƒ9 :
osqltran
ƒƒ: B
.
ƒƒB C

Connection
ƒƒC M
,
ƒƒM N
osqltran
ƒƒO W
,
ƒƒW X
entidad
ƒƒY `
,
ƒƒ` a
clave
ƒƒb g
,
ƒƒg h

parametros
ƒƒi s
)
ƒƒs t
)
ƒƒt u
{
≈≈ 
int
∆∆ 
	resultado
∆∆ 
=
∆∆ 
osqlcom
∆∆  '
.
∆∆' (
ExecuteNonQuery
∆∆( 7
(
∆∆7 8
)
∆∆8 9
;
∆∆9 :
return
»» 
	resultado
»»  
;
»»  !
}
…… 
}
   	
	Hashtable
óó 
_htcomandosql
óó 
=
óó  !
new
óó" %
	Hashtable
óó& /
(
óó/ 0
)
óó0 1
;
óó1 2
private
¢¢ 

SqlCommand
¢¢ 
EstablecerComando
¢¢ ,
(
¢¢, -
SqlConnection
¢¢- :
osqlcon
¢¢; B
,
¢¢B C
SqlTransaction
¢¢D R
osqltran
¢¢S [
,
¢¢[ \
string
¢¢] c
entidad
¢¢d k
,
¢¢k l
string
¢¢m s
clave
¢¢t y
,
¢¢y z
	Hashtable¢¢{ Ñ

parametros¢¢Ö è
)¢¢è ê
{
££ 	
string
§§ 
objetoDB
§§ 
=
§§ 
string
§§ $
.
§§$ %
Concat
§§% +
(
§§+ ,
entidad
§§, 3
,
§§3 4
$str
§§5 8
,
§§8 9
clave
§§: ?
,
§§? @
$str
§§A F
)
§§F G
;
§§G H

SqlCommand
¶¶ 
osqlcom
¶¶ 
;
¶¶ 
if
®® 
(
®® 
_htcomandosql
®® 
.
®® 
ContainsKey
®® )
(
®®) *
objetoDB
®®* 2
)
®®2 3
)
®®3 4
{
©© 
osqlcom
™™ 
=
™™ 
_htcomandosql
™™ '
[
™™' (
objetoDB
™™( 0
]
™™0 1
as
™™2 4

SqlCommand
™™5 ?
;
™™? @
osqlcom
´´ 
.
´´ 

Connection
´´ "
=
´´# $
osqlcon
´´% ,
;
´´, -
osqlcom
¨¨ 
.
¨¨ 
Transaction
¨¨ #
=
¨¨$ %
osqltran
¨¨& .
;
¨¨. /
}
≠≠ 
else
ÆÆ 
{
ØØ 
osqlcom
∞∞ 
=
∞∞ 
new
∞∞ 

SqlCommand
∞∞ (
(
∞∞( )
)
∞∞) *
;
∞∞* +
osqlcom
≤≤ 
.
≤≤ 

Connection
≤≤ "
=
≤≤# $
osqlcon
≤≤% ,
;
≤≤, -
osqlcom
≥≥ 
.
≥≥ 
Transaction
≥≥ #
=
≥≥$ %
osqltran
≥≥& .
;
≥≥. /
osqlcom
¥¥ 
.
¥¥ 
CommandText
¥¥ #
=
¥¥$ %
$"
¥¥& (
{
¥¥( )
entidad
¥¥) 0
}
¥¥0 1
_
¥¥1 2
{
¥¥2 3
clave
¥¥3 8
}
¥¥8 9
_pa
¥¥9 <
"
¥¥< =
;
¥¥= >
osqlcom
µµ 
.
µµ 
CommandType
µµ #
=
µµ$ %
System
µµ& ,
.
µµ, -
Data
µµ- 1
.
µµ1 2
CommandType
µµ2 =
.
µµ= >
StoredProcedure
µµ> M
;
µµM N
SqlCommandBuilder
∑∑ !
.
∑∑! "
DeriveParameters
∑∑" 2
(
∑∑2 3
osqlcom
∑∑3 :
)
∑∑: ;
;
∑∑; <
_htcomandosql
ππ 
[
ππ 
objetoDB
ππ &
]
ππ& '
=
ππ( )
osqlcom
ππ* 1
;
ππ1 2
}
∫∫ %
CargarValoresParametros
ºº #
(
ºº# $
osqlcom
ºº$ +
,
ºº+ ,

parametros
ºº- 7
)
ºº7 8
;
ºº8 9
return
ææ 
osqlcom
ææ 
;
ææ 
}
øø 	
private
«« 
Boolean
«« %
CargarValoresParametros
«« /
(
««/ 0

SqlCommand
««0 :
comando
««; B
,
««B C
	Hashtable
««D M

parametros
««N X
)
««X Y
{
»» 	
if
…… 
(
…… 

parametros
…… 
==
…… 
null
…… "
)
……" #
{
……$ %
return
……& ,
false
……- 2
;
……2 3
}
……4 5
if
   
(
   
comando
   
==
   
null
   
)
    
{
  ! "
return
  # )
false
  * /
;
  / 0
}
  1 2
if
ÀÀ 
(
ÀÀ 
comando
ÀÀ 
.
ÀÀ 

Parameters
ÀÀ "
.
ÀÀ" #
Count
ÀÀ# (
==
ÀÀ) +
$num
ÀÀ, -
)
ÀÀ- .
{
ÀÀ/ 0
return
ÀÀ1 7
true
ÀÀ8 <
;
ÀÀ< =
}
ÀÀ> ?
foreach
ÕÕ 
(
ÕÕ 
SqlParameter
ÕÕ !
param
ÕÕ" '
in
ÕÕ( *
comando
ÕÕ+ 2
.
ÕÕ2 3

Parameters
ÕÕ3 =
)
ÕÕ= >
{
ŒŒ 
if
œœ 
(
œœ 
param
œœ 
.
œœ 
	Direction
œœ #
==
œœ$ & 
ParameterDirection
œœ' 9
.
œœ9 :
ReturnValue
œœ: E
)
œœE F
{
œœG H
continue
œœI Q
;
œœQ R
}
œœS T
if
—— 
(
—— 
!
—— 

parametros
—— 
.
——  
Contains
——  (
(
——( )
param
——) .
.
——. /
ParameterName
——/ <
.
——< =
ToLower
——= D
(
——D E
)
——E F
)
——F G
)
——G H
{
““ 
if
”” 
(
”” 
param
”” 
.
”” 

IsNullable
”” (
)
””( )
{
””* +
continue
””, 4
;
””4 5
}
””6 7
StringBuilder
‘‘ !

_sbmensaje
‘‘" ,
=
‘‘- .
new
‘‘/ 2
StringBuilder
‘‘3 @
(
‘‘@ A
)
‘‘A B
;
‘‘B C

_sbmensaje
’’ 
.
’’ 

AppendLine
’’ )
(
’’) *
$str
’’* `
)
’’` a
;
’’a b

_sbmensaje
÷÷ 
.
÷÷ 

AppendLine
÷÷ )
(
÷÷) *
$str
÷÷* ,
)
÷÷, -
;
÷÷- .

_sbmensaje
◊◊ 
.
◊◊ 

AppendLine
◊◊ )
(
◊◊) *
$str
◊◊* ?
+
◊◊@ A
comando
◊◊B I
.
◊◊I J
CommandText
◊◊J U
)
◊◊U V
;
◊◊V W

_sbmensaje
ÿÿ 
.
ÿÿ 

AppendLine
ÿÿ )
(
ÿÿ) *
$str
ÿÿ* @
+
ÿÿA B
param
ÿÿC H
.
ÿÿH I
ParameterName
ÿÿI V
.
ÿÿV W
ToLower
ÿÿW ^
(
ÿÿ^ _
)
ÿÿ_ `
)
ÿÿ` a
;
ÿÿa b
throw
⁄⁄ 
new
⁄⁄ 
	Exception
⁄⁄ '
(
⁄⁄' (

_sbmensaje
⁄⁄( 2
.
⁄⁄2 3
ToString
⁄⁄3 ;
(
⁄⁄; <
)
⁄⁄< =
)
⁄⁄= >
;
⁄⁄> ?
}
€€ 
param
›› 
.
›› 
Value
›› 
=
›› 

parametros
›› (
[
››( )
param
››) .
.
››. /
ParameterName
››/ <
.
››< =
ToLower
››= D
(
››D E
)
››E F
]
››F G
;
››G H
}
ﬁﬁ 
return
‡‡ 
true
‡‡ 
;
‡‡ 
}
‚‚ 	
private
ÍÍ 
void
ÍÍ .
 RecuperarValoresParametrosSalida
ÍÍ 5
(
ÍÍ5 6

SqlCommand
ÍÍ6 @
comando
ÍÍA H
,
ÍÍH I
	Hashtable
ÍÍJ S

parametros
ÍÍT ^
)
ÍÍ^ _
{
ÎÎ 	
if
ÏÏ 
(
ÏÏ 

parametros
ÏÏ 
==
ÏÏ 
null
ÏÏ "
)
ÏÏ" #
{
ÌÌ 
return
ÓÓ 
;
ÓÓ 
}
ÔÔ 
if
 
(
 
comando
 
==
 
null
 
)
  
{
! "
return
# )
;
) *
}
+ ,
if
ÒÒ 
(
ÒÒ 
comando
ÒÒ 
.
ÒÒ 

Parameters
ÒÒ "
.
ÒÒ" #
Count
ÒÒ# (
==
ÒÒ) +
$num
ÒÒ, -
)
ÒÒ- .
{
ÒÒ/ 0
return
ÒÒ1 7
;
ÒÒ7 8
}
ÒÒ9 :
foreach
ıı 
(
ıı 
SqlParameter
ıı !
param
ıı" '
in
ıı( *
comando
ıı+ 2
.
ıı2 3

Parameters
ıı3 =
)
ıı= >
{
ˆˆ 
if
˜˜ 
(
˜˜ 
param
˜˜ 
.
˜˜ 
	Direction
˜˜ #
==
˜˜$ & 
ParameterDirection
˜˜' 9
.
˜˜9 :
Input
˜˜: ?
)
˜˜? @
{
˜˜A B
continue
˜˜C K
;
˜˜K L
}
˜˜M N
if
¯¯ 
(
¯¯ 
!
¯¯ 
comando
¯¯ 
.
¯¯ 

Parameters
¯¯ '
.
¯¯' (
Contains
¯¯( 0
(
¯¯0 1
param
¯¯1 6
.
¯¯6 7
ParameterName
¯¯7 D
.
¯¯D E
ToLower
¯¯E L
(
¯¯L M
)
¯¯M N
)
¯¯N O
)
¯¯O P
{
˘˘ 
if
˙˙ 
(
˙˙ 
param
˙˙ 
.
˙˙ 

IsNullable
˙˙ (
)
˙˙( )
{
˙˙* +
continue
˙˙, 4
;
˙˙4 5
}
˙˙6 7
if
˚˚ 
(
˚˚ 
param
˚˚ 
.
˚˚ 
	Direction
˚˚ '
!=
˚˚( * 
ParameterDirection
˚˚+ =
.
˚˚= >
ReturnValue
˚˚> I
)
˚˚I J
throw
¸¸ 
new
¸¸ !
	Exception
¸¸" +
(
¸¸+ ,
$str
¸¸, a
)
¸¸a b
;
¸¸b c
}
˝˝ 

parametros
ˇˇ 
[
ˇˇ 
param
ˇˇ  
.
ˇˇ  !
ParameterName
ˇˇ! .
.
ˇˇ. /
ToLower
ˇˇ/ 6
(
ˇˇ6 7
)
ˇˇ7 8
]
ˇˇ8 9
=
ˇˇ: ;
param
ˇˇ< A
.
ˇˇA B
Value
ˇˇB G
;
ˇˇG H
}
ÅÅ 
}
ÉÉ 	
}
ÜÜ 
}àà Ó
CD:\repositoriosGit\Chat\Chat\xSqlService\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str &
)& '
]' (
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str (
)( )
]) *
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *